# 문제은행시스템 요구사항 (MVP 수준 정리)

본 문서는 문제은행시스템의 권한/메뉴 구조와 핵심 기능 요구사항(공통, 관리자, 위원), 분류(단계형) 관리 정책, 문제관리 화면(좌 트리/우 목록/상세) 구성, 분류 트리 및 문항 필터링 API 목록을 **MVP 기준**으로 재정리한 문서이다.

- 본 문서에는 **상세 컬럼(테이블/응답 필드) 정의는 포함하지 않는다.**

---

## 1. MVP 목표

출제 → 검토 → 선정 → 시험지 구성 → 문항 관리의 **기본 운영이 가능한 최소 기능**을 제공한다.

핵심 포인트는 다음과 같다.

- 역할 기반 접근제어(RBAC)
- 의뢰 기반 작업(위원은 **본인 할당 건만**)
- 문항/분류 트리 기반 조회·관리
- 시험지 편성(기본 생성/편집/확정)

---

## 2. 사용자/권한(MVP)

### 2.1 역할

- **관리자(운영자)**
  - 계획 생성/확정, 의뢰 생성/발송/회수/마감, 진행현황 집계
  - 문항/분류 관리, 시험지 생성/확정
- **위원**
  - 본인에게 할당된 의뢰(출제/검토/선정)만 조회/작성/제출

### 2.2 접근 정책(MVP 필수)

- 메뉴 노출 + API 접근 모두 RBAC 적용
- 위원 데이터 범위: **본인 할당 건만 조회/수정**
- URL/파라미터 변조로 타인 데이터 접근 차단(서버에서 최종 검증)

---

## 3. 메뉴/화면(MVP)

### 3.1 공통

- 로그인 / 로그아웃
- 마이페이지(내 정보 조회, 비밀번호 변경)

### 3.2 관리자(MVP)

1) **출제관리**
- 출제계획관리
- 출제의뢰관리
- 출제현황

2) **검토관리**
- 검토계획관리
- 검토의뢰관리
- 검토현황

3) **선정관리**
- 선정계획관리
- 선정의뢰관리
- 선정현황

4) **시험지관리**
- 시험지관리

5) **문제관리**
- 문제관리
- 문제현황(최소 통계/현황)

6) **시스템관리(최소)**
- 사용자관리(운영자/위원)
- 시스템작업로그(조회)
- 공통코드관리(필요 수준)

### 3.3 위원(MVP)

- 출제하기
- 검토하기
- 선정하기

---

## 4. 공통 운영 규칙(MVP)

### 4.1 상태/워크플로우(최소)

업무 단위는 “계획 → 의뢰 → 수행/제출 → 현황 집계” 흐름을 따른다.

- **계획 상태**: 작성중 / 확정 / 마감
- **의뢰 상태**: 미발송 / 발송 / 진행중 / 마감
- **수행 상태(제출물)**: 미작성 / 임시저장 / 제출 / 반려 / 완료

### 4.2 상태 전이(최소 규칙)

- 계획 **확정 후** 의뢰 생성 가능
- 의뢰 **발송 후** 위원 작업 가능(임시저장/제출)
- 반려 시 위원 재수정/재제출 가능
- 마감 이후 위원 수정/제출 불가(정책)
- 확정본(시험지/계획)은 잠금 처리(수정 불가)

### 4.3 감사/로그(MVP 최소)

- 주요 행위(등록/수정/삭제/상태변경/내보내기/다운로드)는 시스템작업로그로 기록
- 로그인 성공/실패, 잠금, 로그아웃(수동/자동) 기록
- 로그 조회 조건(최소): 기간/사용자/메뉴/작업유형

### 4.4 검색/목록 공통(MVP)

- 모든 목록: 페이징, 정렬, 필터(상태/기간/키워드)
- 엑셀 내보내기: 관리자만(정책 적용)

### 4.5 첨부/파일(MVP)

- 계획/의뢰/문항/시험지/양식에 파일 첨부(우선 1개 영역부터 시작 가능)
- 업로드 확장자/용량 제한 및 다운로드 권한 통제

---

## 5. 관리자 기능 요구사항(MVP)

### 5.1 출제관리

#### 5.1.1 출제계획관리
- 계획 등록/수정/삭제/조회
- 계획 확정/마감

#### 5.1.2 출제의뢰관리
- 출제계획 기반 위원 의뢰 생성(개별/일괄)
- 의뢰 발송/마감
- (선택) 재배정(담당 위원 변경) 또는 할당 조정
- 반려(사유 포함) 및 재요청 흐름

#### 5.1.3 출제현황
- 계획 단위/위원 단위 진행률 집계(최소 지표)

### 5.2 검토관리

#### 5.2.1 검토계획관리
- 검토계획 등록/확정/마감
- (선택) 검토 기준 텍스트(단순 저장 수준)

#### 5.2.2 검토의뢰관리
- 검토 대상(문항/세트) 선정 및 검토 의뢰
- 검토 결과(통과/수정필요/부적합) 및 의견 제출

#### 5.2.3 검토현황
- 검토 진행률/결과 집계(최소)

### 5.3 선정관리

#### 5.3.1 선정계획관리
- 선정계획 등록/확정/마감

#### 5.3.2 선정의뢰관리
- 후보 문항 풀 제공 및 선정 의뢰
- 선정/예비/제외 처리 및 사유 기록
- (최소) 중복 선정 방지(동일 시험지 내 중복 차단 등)

#### 5.3.3 선정현황
- 선정 완료율, 계획 대비 충족률(최소)

### 5.4 시험지관리

- 시험지 단위 생성/편집/삭제(정책상 논리삭제 권장)
- 문항 편성(추가/삭제/순서 변경/교체)
- 시험지 확정(확정본 잠금)
- 내보내기/출력(최소 1개 포맷) + 로그 기록

### 5.5 문제관리(문항 마스터)

- 문항 등록/수정/조회/삭제(논리삭제 중심)
- 문항 상태 관리(최소 세트 운영)
- 문항 변경 이력/감사 로그 기록(최소: 누가/언제/무엇을)
- 분류 트리 기반 선택/매핑(등록 시 트리 선택값 기본 반영)
- 목록 검색/필터: 분류, 하위 포함, 키워드, 상태, 난이도, 유형, 기간
- 엑셀 내보내기(관리자만)

### 5.6 시스템관리(최소)

#### 5.6.1 사용자관리
- 운영자/위원 등록/수정/비활성
- 비밀번호 초기화(또는 임시 비밀번호 발급)
- (가능하면) 위원 배정 가능 범위(전문영역/분류) 설정

#### 5.6.2 시스템작업로그
- 주요 작업 이력 조회(기간/사용자/메뉴/작업유형/대상키)

#### 5.6.3 공통코드관리
- 코드 그룹/상세 코드 CRUD(운영에 필요한 수준)

---

## 6. 위원 기능 요구사항(MVP)

### 6.1 출제하기
- 본인 의뢰 목록 조회
- 문항 작성(임시저장/제출)
- 반려 시 재수정/재제출

### 6.2 검토하기
- 본인 의뢰 목록 조회
- 검토 결과(통과/수정필요/부적합) + 의견 제출

### 6.3 선정하기
- 본인 의뢰 목록 조회
- 문항 선정/예비/제외 + 사유 기록

공통 정책
- 마감 이후 수정/제출 불가(정책)

---

## 7. 분류(단계형 트리) 관리 정책(MVP)

### 7.1 트리 구조
- Level 1 ~ N 단계 지원
- UI 권장: 좌 트리 / 우 상세(등록/수정/비활성)

### 7.2 코드/정렬 정책
- 코드 발번: 동일 부모/레벨 내 **max 세그먼트 + 1**
- 결번 재사용: 기본 미사용
- sortKey: 제로패딩 기반 문자열 정렬(숫자 정렬과 동일)

### 7.3 변경/삭제 정책(권장)
- 문항 매핑 존재 분류: **부모 변경 제한**
- 삭제는 비활성(논리삭제) 중심
- 하위 존재/문항 매핑 존재 시 삭제 제한 → 비활성으로 대체

### 7.4 분류 검색
- 분류명/코드 검색 → 트리 하이라이트 및 노드 이동

---

## 8. 문제관리 화면(와이어 수준, MVP)

### 8.1 화면 레이아웃
- 좌측: 분류 트리
  - 트리 검색(분류명/코드)
  - 전체 펼침/접힘
  - 비활성 분류 구분 표시
- 우측 상단: 검색조건
  - 키워드(문항/지문)
  - 상태/난이도/유형/기간
  - 하위 포함 조회(기본 ON 권장)
  - 버튼: 검색/초기화/엑셀(관리자)/문제등록
- 우측 중단: 목록
  - 테이블(페이징/정렬)
  - 행 클릭 시 상세 표시
- 우측 하단 또는 패널: 상세/편집
  - 권장 탭: 기본정보 / 본문 / 보기 / 정답·해설 / 첨부 / 이력
  - MVP 우선: 기본정보 + 본문 + 정답·해설

### 8.2 핵심 동작
- 트리 노드 선택 → 목록 자동 갱신(하위 포함 정책)
- 문제등록 시 트리 선택 분류 기본값 반영
- 미저장 상태에서 이동 시 경고
- 비활성 분류는 신규 등록 선택 제한(정책)

---

## 9. API 목록(MVP 최소)

### 9.1 응답 공통 포맷
- result: success | fail
- message: 사용자 안내 메시지
- errorMessage: 시스템 메시지(정책에 따라 비노출 가능)
- data: 결과 데이터

### 9.2 분류 API
1) 전체 트리 조회(소규모)
- GET /api/classifications/tree
- Query: useYn(Y|N|ALL, default Y), maxDepth(옵션)

2) 자식 노드 조회(지연 로딩)
- GET /api/classifications/children
- Query: parentId, useYn(Y|N|ALL)

3) 분류 검색(트리 탐색)
- GET /api/classifications/search
- Query: q(명/코드), useYn(Y|N|ALL)

### 9.3 문항 API
4) 문항 목록 조회(필터링)
- GET /api/questions
- Query 예시:
  - clsId(옵션)
  - includeDescendants(true|false, default true)
  - keyword(옵션)
  - status(다중 가능, 옵션)
  - difficulty(옵션)
  - type(옵션)
  - page, size(필수)
  - sort(옵션)

5) 문항 상세 조회
- GET /api/questions/{questionId}

### 9.4 옵션 API
6) 분류별 문항 수 조회(트리 배지/현황용, 필요 시)
- GET /api/classifications/question-counts
- Query: parentId(옵션), includeDescendants(true|false)

---

## 10. 품질/보안(최소)

- 입력값 검증(필수값, 길이 제한, 상태값 enum)
- XSS/HTML 입력 정책(문항 본문/해설 허용 범위 정의)
- 파일 업로드 확장자/용량 제한
- 다운로드 권한 체크
- 감사로그 누락 방지(등록/수정/삭제/상태변경/다운로드/내보내기)

---

## 11. MVP 범위에서 제외/후순위(권장)

- 계획/시험지 “정교한 버저닝”(MVP에서는 확정본 잠금 + 변경로그로 대체)
- 검토/선정 통계 고도화(사유 분포, 자동 경고 규칙 등)
- 시험지 내보내기 포맷 다변화(우선 1개 포맷)
- 알림(메일/쪽지), SSO 연동
- 분류 부모 변경 허용(허용 시 코드/경로 재계산 + 이력 필수)
- 문항-분류 다중 매핑(옵션)

---

## 12. MVP 기능 목록 체크리스트(개발/테스트 기준)

아래 체크리스트는 기능 개발 및 수용 테스트(AC) 작성에 바로 사용할 수 있도록 구성했다.

### 12.1 공통(전 권한)

#### 로그인/로그아웃
- [ ] 아이디/비밀번호 로그인
- [ ] 역할별 초기 화면 라우팅(관리자/위원)
- [ ] 로그인 실패 메시지 단순화(계정 존재 여부 등 상세 노출 금지)
- [ ] 로그인 실패 횟수 초과 시 계정 잠금(정책값)
- [ ] 세션 타임아웃(미사용 시간) 및 자동 로그아웃
- [ ] 로그인 성공/실패/잠금/로그아웃(수동/자동) 로그 기록

#### 마이페이지
- [ ] 내 정보 조회
- [ ] 비밀번호 변경(최소 정책)
- [ ] 개인정보/비밀번호 변경 로그 기록

### 12.2 RBAC/데이터 범위(필수)
- [ ] 메뉴 노출 제어(관리자/위원)
- [ ] API 접근 제어(관리자/위원)
- [ ] 위원 데이터 범위: 본인 할당 건만 조회/수정
- [ ] 서버에서 최종 권한 검증(직접 URL/파라미터 변조 차단)

### 12.3 상태/워크플로우(공통)
- [ ] 계획(작성중/확정/마감) 상태에 따른 수정/생성 제한
- [ ] 의뢰(미발송/발송/진행중/마감) 상태에 따른 위원 작업 가능 여부
- [ ] 수행(미작성/임시저장/제출/반려/완료) 흐름 및 반려 사유 전달
- [ ] 마감 이후 위원 수정/제출 불가
- [ ] 확정본 잠금(시험지/계획 등) 적용

### 12.4 관리자 기능

#### 계획관리(출제/검토/선정)
- [ ] 계획 등록/수정/삭제/조회
- [ ] 확정/마감
- [ ] 목록: 페이징/필터(기간/상태/키워드)

#### 의뢰관리(출제/검토/선정)
- [ ] 계획 기반 의뢰 생성(개별/일괄)
- [ ] 발송/마감
- [ ] (선택) 재배정 또는 할당 조정
- [ ] 반려(사유 필수) 및 재요청

#### 현황(출제/검토/선정)
- [ ] 계획별 진행률(할당 대비 제출/반려/완료 등 최소 지표)
- [ ] 위원별 진행률

#### 시험지관리
- [ ] 시험지 생성/편집/삭제(논리삭제 권장)
- [ ] 문항 편성(추가/삭제/순서/교체)
- [ ] 시험지 확정(잠금)
- [ ] 내보내기/출력(최소 1개 포맷) + 로그

#### 문제관리(문항 마스터)
- [ ] 문항 CRUD(논리삭제 중심)
- [ ] 문항 상태 관리(최소 세트)
- [ ] 분류 트리 기반 매핑 및 등록 기본값 반영
- [ ] 검색/필터(분류/하위포함/키워드/상태/난이도/유형/기간)
- [ ] 변경 이력/감사 로그(최소)
- [ ] 엑셀 내보내기(관리자)

#### 시스템관리(최소)
- [ ] 사용자관리(운영자/위원 등록·수정·비활성)
- [ ] 비밀번호 초기화(또는 임시 발급)
- [ ] 작업로그 조회(기간/사용자/메뉴/작업유형)
- [ ] 공통코드관리(필요 수준)

### 12.5 위원 기능
- [ ] 출제하기: 본인 의뢰 목록 → 문항 작성(임시저장/제출) → 반려 시 재제출
- [ ] 검토하기: 본인 의뢰 목록 → 결과(통과/수정필요/부적합) + 의견 제출
- [ ] 선정하기: 본인 의뢰 목록 → 선정/예비/제외 + 사유 제출
- [ ] 마감 이후 수정/제출 불가

### 12.6 분류관리(단계형 트리)
- [ ] 트리 조회(전체 또는 지연로딩 중 1개 방식)
- [ ] 등록/수정/비활성
- [ ] 발번(max+1), 결번 미재사용
- [ ] sortKey(제로패딩)
- [ ] 검색(명/코드) → 트리 하이라이트/이동
- [ ] 하위/문항 매핑 존재 시 삭제 제한(비활성 대체)
- [ ] 문항 매핑 존재 시 부모 변경 제한(권장)

---

## 13. 한눈에 보는 MVP 요약

- 공통: 로그인/로그아웃, 마이페이지, 감사로그
- 권한: 메뉴+API RBAC, 위원은 본인 할당 건만
- 워크플로우: 계획/의뢰/수행 최소 상태와 잠금(확정/마감)
- 관리자: 계획/의뢰/현황(출제·검토·선정), 시험지 편성/확정, 문항 마스터/검색, 사용자/로그
- 위원: 출제/검토/선정 의뢰 처리(임시저장/제출/반려)
- 분류: 트리 기반 관리 + 발번/정렬/비활성 정책
- API: 분류(tree/children/search), 문항(list/detail), 공통 래퍼

